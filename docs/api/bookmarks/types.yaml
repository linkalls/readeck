---
# SPDX-FileCopyrightText: Â© 2023 Olivier Meunier <olivier@neokraft.net>
#
# SPDX-License-Identifier: AGPL-3.0-only

schemas:
  bookmarkSummary:
    type: object
    properties:
      id:
        type: string
        format: short-uid
        description: Bookmark's ID
      href:
        type: string
        format: uri
        description: Link to the bookmark info
      created:
        type: string
        format: date-time
        description: Creation date
      updated:
        type: string
        format: date-time
        description: Last update
      state:
        type: integer
        enum: [0, 1, 2]
        description: |
          Indicates the state of the bookmark.
          - `0`: loaded
          - `1`: error
          - `2`: loading
      loaded:
        type: boolean
        description: Becomes true when the bookmark is ready (regardless of its error state)
      url:
        type: string
        format: uri
        description: Bookmark's original URL
      title:
        type: string
        description: Bookmark's title
      site_name:
        type: string
        description: Bookmark's site name
      site:
        type: string
        format: hostname
        description: Bookmark's site host name
      published:
        type: [string]
        format: date-time
        nullable: true
        description: Publication date. Can be `null` when unknown.
      authors:
        type: array
        items:
          type: string
        description: Author list
      lang:
        type: string
        description: Language Code
      text_direction:
        type: string
        enum: [rtl, ltr]
        description: |
          Direction of the article's text. It can be empty when it's unknown.
      document_type:
        type: string
        description: |
          The bookmark document type. This is usualy the same value as `type` but it can differ
          depending on the extraction process.
      type:
        type: string
        enum: [article, photo, video]
        description: |
          The bookmark type. Unlike `document_type`, this can only be one of the 3 values.
      has_article:
        type: boolean
        description: |
          Indicates whether the bookmarks contains an article. Please not that
          there can be an article on any type.
      description:
        type: string
        description: |
          Bookmark's short description, when it exists. It's always an unformatted text.
      is_deleted:
        type: boolean
        description: |
          `true` when the bookmark is scheduled for deletion.
      is_marked:
        type: boolean
        description: |
          `true` when the bookmark is in the favorites.
      is_archived:
        type: boolean
        description: |
          `true` when the bookmark is in the archives.
      labels:
        type: array
        items:
          type: string
        description: Bookmark's labels
      resources:
        type: object
        description: |
          This contains a list of resources associated with the bookmark.
          The only fields that are always present are `log` and `props`.
          The `article` field is only present when a bookmark provides a
          text content. Other image fields depend on what was found during
          extraction.
        properties:
          article:
            $ref: "#/components/schemas/bookmarkResource"
            description: Link to the article, when there is one.
          icon:
            $ref: "#/components/schemas/bookmarkResourceImage"
            description: Link and information for the site icon.
          image:
            $ref: "#/components/schemas/bookmarkResourceImage"
            description: Link and information for the article image.
          thumbnail:
            $ref: "#/components/schemas/bookmarkResourceImage"
            description: Link and information for the article thumbnail.
          log:
            $ref: "#/components/schemas/bookmarkResource"
            description: Link to the extraction log.
          props:
            $ref: "#/components/schemas/bookmarkResource"
            description: Link to the bookmark's extra properties.

  bookmarkResource:
    type: object
    properties:
      src:
        type: string
        format: uri
        description: URL of the resource

  bookmarkResourceImage:
    allOf:
      - $ref: "#/components/schemas/bookmarkResource"
      - type: object
        properties:
          height:
            type: integer
            description: Image height
          width:
            type: integer
            description: Image width

  bookmarkInfo:
    allOf:
      - $ref: "#/components/schemas/bookmarkSummary"
      - type: object
        properties:
          links:
            description: |
              This contains the list of all the links collected in the
              retrieved article.
            type: array
            items:
              properties:
                url:
                  type: string
                  format: uri
                  description: Link URI
                domain:
                  type: string
                  format: hostname
                  description: Link's domain
                title:
                  type: string
                  description: Link's title
                is_page:
                  type: boolean
                  description: |
                    `true` when the destination is a web page
                content_type:
                  type: string
                  description: MIME type of the destination

  bookmarkCreate:
    required: [url]
    properties:
      url:
        type: string
        description: URL to fetch
      title:
        type: string
        description: Title of the bookmark
      labels:
        type: array
        items:
          type: string
        description: List of labels to set to the bookmark
