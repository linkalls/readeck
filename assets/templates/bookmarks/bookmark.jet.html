{{ extends "/base" }}
{{ import "./components/common" }}
{{ import "./components/card_blocks" }}

{{- block title() -}}
  {{- if !.Item.Loaded -}}
    Bookmark loading
  {{- else -}}
    {{ .Item.Title }}
  {{- end }} - Bookmarks
{{- end -}}

{{- block head() -}}
  {{- if !.Item.Loaded -}}
    <noscript><meta http-equiv="refresh" content="5"></noscript>
  {{- end -}}
{{- end -}}

{{- block body() -}}
<div class="flex h-screen +sm:flex-col">
  {{ include "/menu" }}

  <div class="grow md:overflow-y-auto">
    <turbo-frame id="bookmark-{{ .Item.ID }}" data-controller="turbo-refresh"
    data-turbo-refresh-on-value="[data-deleted]"
    data-turbo-refresh-interval-value="3"
    class="
      flex +md:flex-col
      +md:h-screen
      +sm:h-[calc(100vh-4rem)]
    ">
      {{- if !.Item.Loaded -}}
        <div class="text-center mt-8">
          <span class="text-3xl">{{ yield spinner() }}</span>
          <p class="text-lg">Bookmark is loadingâ€¦</p>
        </div>
      {{- else -}}
        <input type="checkbox" id="--panel-toggle" class="peer hidden">
        <div class="
          order-last w-col-6 h-screen sticky top-0 overflow-y-auto
          flex-shrink-0
          border-l border-l-gray-200
          +md:w-full
          +md:overflow-y-hidden
          +md:h-topnav +md:flex +md:flex-col
          +md:shadow-panel-t
          +md:peer-checked:h-[60vh]
          +md:transition-all +md:ease-in-out
          +md:peer-checked:[&>div>label>span>svg]:rotate-180
         ">
          <div class="
            h-topnav border-b border-b-gray-200 flex-shrink-0
            px-6 +md:px-4
            flex items-center justify-end
          ">
            <label for="--panel-toggle" class="
              md:hidden
              cursor-pointer
              w-12 h-12 bg-gray-600 text-white
              inline-flex items-center justify-center
              rounded-2xl
              select-none
            ">{{- yield icon(name="o-chevron-u", class="inline-block", svgClass="w-6 h-6") -}}</label>
          </div>
          <div class="px-6 pt-4 pb-8 +md:px-4 +md:overflow-y-auto flex-grow">
            {{ include "./components/sidebar" }}
          </div>
        </div>

        <div class="
          grow max-w-col-22 px-6 pb-8
          +md:px-4
          +md:overflow-auto
        ">
          <div class="h-topnav border-b border-b-gray-200"></div>
          <div class="max-w-3xl mx-auto mt-4 print:mt-2 print:max-w-none mb-8">
            {{ include "./components/title_form" .Item }}

            {{- if !empty(.Item.Description) -}}
              <p class="mt-2 text-lg leading-tight text-justify font-serif italic">{{ .Item.Description }}</p>
            {{- end -}}
            {{- if user.Settings.DebugInfo -}}
              {{ include "./components/debug" map("log", ._log, "props", ._props) }}
            {{- end -}}
          </div>

          {{ include "./components/content_block" map(
            "Item", .Item,
            "Out", .Out,
            "HTML", .HTML
          ) }}

          <div class="mx-auto mt-6 pt-6 border-t print:hidden">
          {{- include "./components/bottom_actions" .Item -}}
          </div>
        </div>

      {{- end -}}
    </turbo-frame>
  </div>
</div>
{{- end -}}
